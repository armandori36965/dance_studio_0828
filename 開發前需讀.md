# 舞蹈工作室管理系統 - Filament 4.x 開發規範文檔

## 📋 開發前必讀準則

**⚠️ 重要提醒：每次開發前必須完整閱讀此文檔！**

---

## 🎯 開發者身份

你是高級程式開發工程師，具備豐富的 Laravel + Filament 4.x 開發經驗。

---

## 🔍 開發前檢查流程

### 1. 專案整體檢視

-   [ ] 完整檢視整個專案結構
-   [ ] 了解現有功能和模組
-   [ ] 檢查資料庫結構和模型
-   [ ] 檢視現有 Filament 資源和頁面
-   [ ] 確認現有 Widget 和自訂義組件

### 2. 業務需求分析

-   [ ] 明確理解當前要開發的業務需求
-   [ ] 檢查是否與現有功能重複
-   [ ] 確認開發範圍和優先級
-   [ ] 評估對現有系統的影響

### 3. 重複開發檢查

-   [ ] 搜尋專案中是否已有相似功能
-   [ ] 檢查是否有重複的 Filament 資源、頁面、Widget
-   [ ] 確認是否可以使用現有組件
-   [ ] 避免重複造輪子

---

## 🛠️ 技術規範

### 1. Filament 4.x 優先原則

**除非有特殊要求，一律使用 Filament 4.x 原生組件，不使用自訂義**

#### 使用 Filament 的範圍：

-   ✅ 資源管理（Resources）
-   ✅ 頁面（Pages）
-   ✅ Widget 組件
-   ✅ 表單組件（Forms）
-   ✅ 表格組件（Tables）
-   ✅ 資訊列表（Infolists）
-   ✅ 導航和佈局
-   ✅ 認證和權限
-   ✅ 主題和樣式

#### 自訂義限制：

-   ❌ 不自行設計 UI 組件（除非 Filament 原生不支援）
-   ❌ 不修改 Filament 核心樣式
-   ❌ 不引入其他 UI 框架
-   ❌ 不重複實現已有功能

### 2. 本地資源原則

**嚴格禁止使用 CDN，所有資源必須本地化**

#### 已本地化的資源：

-   ✅ Filament 核心資源
-   ✅ 字體檔案
-   ✅ 圖片資源
-   ✅ JavaScript 和 CSS 檔案

#### 資源引用方式：

```php
// 正確：使用 Filament 原生組件
use Filament\Forms\Components\TextInput;
use Filament\Tables\Columns\TextColumn;

// 錯誤：使用自訂義 HTML
echo '<input type="text" class="form-control">';
```

---

## 📁 專案結構規範

### Filament 4.x 標準結構

```
dance_studio_0828/
├── app/
│   ├── Filament/
│   │   ├── Resources/           # Filament 資源
│   │   │   ├── Users/          # 用戶管理資源
│   │   │   ├── Campuses/       # 校區管理資源
│   │   │   ├── SchoolEvents/   # 校務活動資源
│   │   │   ├── Courses/        # 課程管理資源
│   │   │   ├── Attendances/    # 出勤管理資源
│   │   │   ├── Equipment/      # 設備管理資源
│   │   │   └── Finances/       # 財務管理資源
│   │   ├── Pages/              # 自訂義頁面
│   │   ├── Widgets/            # Widget 組件
│   │   ├── Clusters/           # 資源群組
│   │   └── Providers/          # 服務提供者
│   ├── Models/                 # 資料模型
│   └── Http/Controllers/       # 傳統控制器（如需要）
├── database/
│   ├── migrations/             # 資料庫遷移
│   └── seeders/                # 資料填充
├── resources/
│   └── views/                  # Blade 視圖（如需要）
└── routes/
    └── web.php                 # 路由定義
```

---

## 🔧 開發流程

### 1. 需求確認

-   明確功能需求
-   確認使用者角色和權限
-   定義資料結構

### 2. 資料庫設計

-   建立遷移檔案
-   定義模型關係
-   建立資料填充

### 3. Filament 資源開發

-   建立 Filament 資源
-   定義表單、表格、資訊列表
-   設定權限和導航

### 4. 自訂義組件開發

-   建立自訂義 Widget（如需要）
-   建立自訂義頁面（如需要）
-   整合現有功能

### 5. 測試驗證

-   功能測試
-   權限測試
-   介面測試

---

## 📝 程式碼規範

### 1. 命名規範

-   Filament 資源：`PascalCase`（如：`UserResource`）
-   模型：`PascalCase`（如：`User`）
-   路由：`kebab-case`（如：`admin.users`）
-   檔案：`PascalCase`（如：`UserResource.php`）

### 2. 註解規範

#### 中文註解原則

-   **所有程式碼註解必須使用中文**
-   **PHP 註解使用中文**：`// 這是中文註解` 或 `/* 這是中文註解 */`
-   **HTML 註解使用中文**：`<!-- 這是中文註解 -->`
-   **JavaScript 註解使用中文**：`// 這是中文註解` 或 `/* 這是中文註解 */`
-   **CSS 註解使用中文**：`/* 這是中文註解 */`

#### 註解範例

```php
// 用戶資源類別
class UserResource extends Resource
{
    // 設定模型
    protected static ?string $model = User::class;

    // 設定導航圖示
    protected static string|BackedEnum|null $navigationIcon = Heroicon::OutlinedUsers;

    // 設定表單
    public static function form(Form $form): Form
    {
        return $form
            ->schema([
                // 用戶姓名欄位
                TextInput::make('name')
                    ->label('姓名')
                    ->required()
                    ->maxLength(255),

                // 電子郵件欄位
                TextInput::make('email')
                    ->label('電子郵件')
                    ->email()
                    ->required()
                    ->unique(ignoreRecord: true),
            ]);
    }
}
```

### 3. 註釋規範

-   **所有註釋必須使用中文**
-   重要功能必須有註釋說明
-   複雜邏輯需要詳細註釋
-   **程式碼中的註解一律使用中文**

### 4. 檔案組織

-   相關功能放在同一目錄
-   遵循 Filament 慣例
-   保持目錄結構清晰

---

## 🚫 禁止事項

### 1. 技術限制

-   ❌ 不使用 CDN 資源
-   ❌ 不重複開發已有功能
-   ❌ 不修改 Filament 核心檔案
-   ❌ 不引入不必要的第三方套件
-   ❌ **不使用英文註解**

### 2. 開發限制

-   ❌ 不跳過需求分析
-   ❌ 不忽略現有程式碼
-   ❌ 不重複造輪子
-   ❌ 不違反專案架構

---

## ✅ 開發檢查清單

### 開發前檢查

-   [ ] 已完整閱讀此文檔
-   [ ] 已檢視整個專案結構
-   [ ] 已確認業務需求
-   [ ] 已檢查重複開發
-   [ ] 已確認使用 Filament 組件

### 開發中檢查

-   [ ] 使用 Filament 原生組件
-   [ ] 遵循 Filament 設計規範
-   [ ] 保持程式碼一致性
-   [ ] **所有註解使用中文**
-   [ ] 添加適當註釋

### 開發後檢查

-   [ ] 功能測試通過
-   [ ] 權限控制正確
-   [ ] 介面符合設計
-   [ ] 程式碼品質良好

---

## 📚 參考資源

### Filament 資源

-   官方文件：https://filamentphp.com/docs
-   組件庫：https://filamentphp.com/docs/4.x/forms/fields
-   表格組件：https://filamentphp.com/docs/4.x/tables/columns
-   權限管理：https://filamentphp.com/docs/4.x/panels/auth

### 專案文檔

-   模型關係：`app/Models/`
-   Filament 資源：`app/Filament/Resources/`
-   資料庫結構：`database/migrations/`

---

## 🔄 版本控制

### 提交規範

-   每次提交前檢查是否符合規範
-   提交訊息使用中文
-   包含功能描述和影響範圍

### 分支管理

-   新功能使用 feature 分支
-   修復使用 hotfix 分支
-   合併前進行程式碼審查

---

## 🎨 Filament 4.x 特色功能

### 1. 資源管理

```php
// 標準資源結構
class UserResource extends Resource
{
    protected static ?string $model = User::class;

    public static function form(Form $form): Form
    {
        return $form->schema([
            // 表單欄位
        ]);
    }

    public static function table(Table $table): Table
    {
        return $table->columns([
            // 表格欄位
        ]);
    }
}
```

### 2. 權限管理

```php
// 使用 Filament 權限系統
protected static function getNavigationBadge(): ?string
{
    return static::getModel()::count();
}

public static function canCreate(): bool
{
    return auth()->user()->can('create', static::getModel());
}
```

### 3. 自訂義 Widget

```php
// 建立自訂義 Widget
class StatsOverview extends BaseWidget
{
    protected function getStats(): array
    {
        return [
            Stat::make('總用戶數', User::count()),
            Stat::make('活躍用戶', User::where('status', 'active')->count()),
        ];
    }
}
```

---

**📌 重要提醒：每次開發前必須重新閱讀此文檔，確保遵循所有規範！**

---

_最後更新：2025 年 9 月 1 日_
_版本：2.0 - Filament 4.x_
